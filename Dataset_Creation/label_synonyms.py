"""Synonym and subcategory expansions for roof observation labels."""
from __future__ import annotations
from typing import Dict, List

# Keys stored in lowercase for canonical comparison.
_LABEL_SYNONYMS: Dict[str, List[str]] = {'apron': ['apron flashing',
           'roof apron flashing',
           'base apron',
           'headwall apron',
           'wall apron flashing'],
 'asphalt deterioration (blueberries)': ['blueberrying',
                                         'asphalt blueberries',
                                         'bitumen pop outs',
                                         'asphalt surface bubbles',
                                         'bituminous blueberries'],
 'backed out fasteners': ['backed-out screws',
                          'fasteners backing out',
                          'loose fasteners',
                          'fastener uplift',
                          'exposed fastener threads'],
 'backpan': ['back pan flashing',
             'headwall back pan',
             'chimney backpan',
             'counterflashing back pan',
             'backpan flashing'],
 'closed/woven valley': ['woven valley',
                         'closed valley',
                         'woven shingle valley',
                         'closed shingle valley',
                         'woven roof valley'],
 'condensate trap': ['hvac condensate trap',
                     'condensate drain trap',
                     'drain trap',
                     'unit condensate trap',
                     'condensate piping trap'],
 'conduit penetration through mech. unit': ['conduit through mechanical unit',
                                            'mechanical unit conduit penetration',
                                            'electrical conduit penetration',
                                            'equipment conduit penetration',
                                            'conduit penetration through curb'],
 'control/expansion joint': ['expansion joint',
                             'control joint',
                             'roof expansion joint',
                             'membrane expansion joint',
                             'control joint cover'],
 'cricket': ['saddle',
             'cricket saddle',
             'diverter cricket',
             'chimney cricket',
             'back slope cricket'],
 'curb height': ['low curb height',
                 'insufficient curb height',
                 'curb elevation',
                 'mechanical curb height',
                 'parapet curb height'],
 'curb membrane flashings': ['curb flashing membrane',
                             'membrane flashings at curb',
                             'base flashing at curb',
                             'curb base flashing',
                             'curb membrane base'],
 'curb membrane flashings tenting': ['curb flashing tenting',
                                     'membrane tenting at curb',
                                     'curb base flashing ballooning',
                                     'curb flashing uplift',
                                     'tenting base flashing'],
 'curb metal flashings': ['metal curb flashing',
                          'counterflashing at curb',
                          'metal flashings at curb',
                          'curb counter flashing',
                          'sheet metal curb flashing'],
 'damaged panels': ['damaged roof panels',
                    'panel damage',
                    'bent roof panels',
                    'broken panels',
                    'distorted panels'],
 'damaged shingles': ['broken shingles',
                      'shingle damage',
                      'cracked shingles',
                      'missing shingle tabs',
                      'shingle tearing'],
 'debris': ['roof debris',
            'rooftop debris',
            'surface debris',
            'debris accumulation',
            'foreign debris'],
 'degranulated cap sheet membrane': ['cap sheet degranulation',
                                     'loss of granules',
                                     'granule loss',
                                     'cap sheet wear',
                                     'bare cap sheet'],
 'displaced ballast': ['ballast displacement',
                       'moved ballast',
                       'ballast scour',
                       'missing ballast',
                       'bare membrane ballast'],
 'displaced ballast/wind scour': ['wind scour',
                                  'wind scoured ballast',
                                  'ballast wind displacement',
                                  'ballast scouring',
                                  'wind removed ballast'],
 'door sill flashings': ['door threshold flashing',
                         'sill flashing',
                         'door sill metal',
                         'entrance sill flashing',
                         'door pan flashing'],
 'drain plumbing clogged': ['clogged drain piping',
                            'blocked drain plumbing',
                            'drain line blockage',
                            'roof drain piping clog',
                            'clogged drain leader'],
 'drain screen clogged': ['clogged drain strainer',
                          'blocked drain screen',
                          'roof drain basket clogged',
                          'plugged drain screen',
                          'screen obstruction'],
 'drip edge': ['roof drip edge',
               'drip edge flashing',
               'edge metal',
               'drip flashing',
               'perimeter drip edge'],
 'ductwork seals': ['duct sealant',
                    'duct joint seal',
                    'failed duct seals',
                    'ductwork joints leaking',
                    'duct seam seal'],
 'end/side laps': ['end lap', 'side lap', 'panel lap', 'lap seam', 'lap joint'],
 'equipment securement': ['equipment anchorage',
                          'equipment tie down',
                          'mechanical unit securement',
                          'equipment fastenings',
                          'equipment restraint'],
 'equipment support mechanism': ['equipment support',
                                 'hvac support frame',
                                 'equipment stand',
                                 'support curb',
                                 'equipment pedestal'],
 'exposed fasteners': ['exposed screws',
                       'fastener heads exposed',
                       'fasteners without sealant',
                       'exposed screw heads',
                       'fastener exposure'],
 'exposed membrane': ['exposed roof membrane',
                      'membrane exposure',
                      'bare membrane',
                      'membrane not covered',
                      'unprotected membrane'],
 'fascia': ['fascia board', 'fascia metal', 'fascia trim', 'parapet fascia', 'perimeter fascia'],
 'field wrap membrane flashing': ['field wrapped flashing',
                                  'field fabricated flashing',
                                  'hand wrapped membrane',
                                  'field wrap base flashing',
                                  'site fabricated flashing'],
 'fixed ladder': ['roof access ladder',
                  'fixed ladder system',
                  'permanent ladder',
                  'wall mounted ladder',
                  'fixed roof ladder'],
 'gable edge': ['rake edge', 'gable rake', 'rake metal', 'gable trim', 'rake flashing'],
 'guardrail': ['roof guardrail',
               'safety guardrail',
               'perimeter guardrail',
               'railing system',
               'safety railing'],
 'gutter system': ['roof gutter',
                   'gutter assembly',
                   'gutter trough',
                   'rain gutter system',
                   'eaves gutter'],
 'gutter/downspout system': ['gutter and downspout',
                             'rainwater leaders',
                             'roof drainage system',
                             'gutter downspout assembly',
                             'eavestrough system'],
 'heat tracing system': ['heat trace',
                         'heat tape',
                         'gutter heat trace',
                         'de-icing cable',
                         'heat tracing cable'],
 'hip': ['hip ridge', 'hip line', 'hip flashing', 'hip cap', 'hip joint'],
 'hot stack': ['exhaust stack', 'flue stack', 'vent stack', 'thermal stack', 'chimney stack'],
 'insulated ductwork': ['insulated duct',
                        'duct with insulation',
                        'hvac duct insulation',
                        'insulated rooftop duct',
                        'lagged ductwork'],
 'joint membrane flashings': ['membrane joint flashing',
                              'flashings at joint',
                              'joint base flashing',
                              'membrane joint cover',
                              'joint flashing membrane'],
 'joint metal flashings': ['metal joint flashing',
                           'joint counterflashing',
                           'joint sheet metal',
                           'joint cap flashing',
                           'metal joint cover'],
 'membrane billowing': ['membrane ballooning',
                        'billowing membrane',
                        'uplifted membrane',
                        'membrane flutter',
                        'membrane inflating'],
 'membrane blisters/ridges': ['membrane blisters',
                              'membrane ridges',
                              'roof blisters',
                              'raised ridges',
                              'membrane bumping'],
 'membrane blisters/ridges/fishmouths': ['membrane fishmouths',
                                         'fishmouth blisters',
                                         'ridging and fishmouths',
                                         'open laps fishmouth',
                                         'blistered membrane'],
 'membrane fasteners failure': ['failed membrane fasteners',
                                'fastener failure',
                                'membrane fastener pull-out',
                                'loose membrane fasteners',
                                'uplifted fasteners'],
 'membrane flashings under fenestrations': ['fenestration flashing',
                                            'window base flashing',
                                            'curb under window flashing',
                                            'membrane flashing below skylight',
                                            'flashing under glazing'],
 'metal cap/rain collar': ['rain collar',
                           'metal rain cap',
                           'pipe collar',
                           'metal pipe cap',
                           'rain bonnet'],
 'metal edge flashing': ['edge metal flashing',
                         'perimeter edge metal',
                         'edge flashing',
                         'metal drip edge',
                         'fascia metal flashing'],
 'metal wall counterflashing': ['wall counterflashing',
                                'metal counter flashing',
                                'reglet counterflashing',
                                'wall metal flashing',
                                'counter flashing metal'],
 'missing/backed out fasteners': ['missing fasteners',
                                  'backed-out screws',
                                  'fasteners missing',
                                  'loose fasteners',
                                  'fasteners absent'],
 'no access': ['area inaccessible',
               'no roof access',
               'inaccessible roof area',
               'restricted access',
               'access not available'],
 'open valley': ['open metal valley',
                 'open shingle valley',
                 'exposed valley flashing',
                 'open roof valley',
                 'valley metal exposed'],
 'other': ['miscellaneous condition',
           'other condition',
           'non-standard issue',
           'unlisted issue',
           'special condition'],
 'panel joints/seams': ['panel seams',
                        'panel joints',
                        'metal panel seams',
                        'panel lap joints',
                        'panel seam separation'],
 'perimeter fixture': ['perimeter attachment',
                       'edge fixture',
                       'parapet fixture',
                       'perimeter mounted device',
                       'edge mounted fixture'],
 'perimeter membrane flashings': ['perimeter flashing',
                                  'base flashing',
                                  'perimeter base flashing',
                                  'membrane flashings at edge',
                                  'parapet base flashing'],
 'perimeter metal flashings': ['perimeter metal',
                               'edge metal flashing',
                               'parapet metal flashing',
                               'metal trim',
                               'edge flashing metal'],
 'pitch pocket': ['pitch pan',
                  'pitch pocket flashing',
                  'sealant pocket',
                  'pitch pan flashing',
                  'pourable sealer pocket'],
 'ponding water': ['standing water',
                   'roof ponding',
                   'water ponding',
                   'water accumulation',
                   'ponded water'],
 'prefabricated sleeve': ['prefab sleeve',
                          'preformed sleeve',
                          'factory sleeve flashing',
                          'prefabricated pipe sleeve',
                          'pre-made sleeve'],
 'prefabricated sleeve or boot flashing': ['preformed boot',
                                           'prefabricated boot flashing',
                                           'pre-made sleeve flashing',
                                           'factory boot flashing',
                                           'pipe boot flashing'],
 'punctured membrane': ['membrane puncture',
                        'puncture',
                        'membrane hole',
                        'roof puncture',
                        'membrane penetration'],
 'rafting insulation/ponding water': ['insulation rafting',
                                      'floating insulation',
                                      'raised insulation',
                                      'insulation uplift from ponding',
                                      'insulation displacement'],
 'redundant curb': ['abandoned curb',
                    'unused curb',
                    'redundant roof curb',
                    'obsolete curb',
                    'decommissioned curb'],
 'redundant mechanical equipment': ['abandoned equipment',
                                    'unused mechanical unit',
                                    'redundant hvac',
                                    'decommissioned equipment',
                                    'out of service equipment'],
 'redundant roof penetrations': ['abandoned penetration',
                                 'unused penetration',
                                 'sealed penetration',
                                 'redundant penetration',
                                 'decommissioned penetration'],
 'ridge': ['ridge line', 'ridge cap', 'roof ridge', 'ridge flashing', 'ridge board'],
 'roof access point landing': ['roof access landing',
                               'roof hatch landing',
                               'access platform',
                               'access ladder landing',
                               'roof entry landing'],
 'roof anchor': ['tie-off anchor',
                 'fall arrest anchor',
                 'roof safety anchor',
                 'anchor point',
                 'lifeline anchor'],
 'roof anchor failure': ['failed roof anchor',
                         'anchor malfunction',
                         'anchor failure',
                         'damaged anchor point',
                         'unsafe anchor'],
 'roof anchor sleeve': ['roof anchor flashing',
                        'roof anchor flashings',
                        'anchor flashing',
                        'anchor flashings',
                        'sealant collar',
                        'sealant collars',
                        'prefabricated sleeve',
                        'prefabricated sleeves',
                        'anchor grommet',
                        'anchor grommets',
                        'roof anchor seal',
                        'anchor sleeve',
                        'roof anchor grommet',
                        'anchor sleeve flashing',
                        'roof anchor collar',
                        'tie-off sleeve'],
 'roof drain': ['roof drain bowl',
                'roof drain assembly',
                'primary roof drain',
                'roof drain outlet',
                'drain sump'],
 'roof membrane tie-in': ['membrane tie in',
                          'tie-in flashing',
                          'roof tie in',
                          'transition tie-in',
                          'tie-in seam'],
 'roof transition': ['roof step transition',
                     'roof-to-roof transition',
                     'roof level change',
                     'transition flashing',
                     'system transition'],
 'rusted/corroded metal': ['corroded metal',
                           'rusted metal',
                           'oxidized metal',
                           'metal corrosion',
                           'rust spots'],
 'scupper drain': ['scupper',
                   'wall scupper',
                   'through-wall scupper',
                   'scupper box',
                   'scupper outlet'],
 'sediment accumulation': ['sediment build-up',
                           'silt accumulation',
                           'sediment deposits',
                           'dirt accumulation',
                           'sediment buildup'],
 'sediment accumulation within eavestrough/downspouts': ['gutter sediment',
                                                         'downspout sediment',
                                                         'sediment in gutter',
                                                         'sediment in downspout',
                                                         'silt in eavestrough'],
 'shingle overlap (head and lateral)': ['shingle headlap',
                                        'shingle sidelap',
                                        'shingle overlap',
                                        'shingle lap coverage',
                                        'head and side lap'],
 'skylight': ['roof skylight',
              'glazed skylight',
              'skylight assembly',
              'skylight unit',
              'rooflight'],
 'sleepers': ['equipment sleepers',
              'wood sleepers',
              'roof sleepers',
              'pipe sleepers',
              'sleepers blocking'],
 'snow guard system': ['snow retention',
                       'snow guards',
                       'snow fence',
                       'snow retention system',
                       'snow stop system'],
 'soffit': ['eave soffit', 'soffit panel', 'soffit system', 'underside of eave', 'soffit board'],
 'staircase': ['roof staircase',
               'stair access',
               'stair tower',
               'stairwell access',
               'stair access point'],
 'static vent': ['static roof vent',
                 'passive vent',
                 'roof turtle vent',
                 'roof louver vent',
                 'static exhaust vent'],
 'step flashing': ['step flashing pieces',
                   'wall step flashing',
                   'step tin',
                   'step shingles flashing',
                   'sidewall flashing'],
 'subsurface moisture': ['moisture below membrane',
                         'insulation moisture',
                         'trapped moisture',
                         'subsurface wet insulation',
                         'moisture under roof'],
 'temporary repairs': ['temporary patch',
                       'temporary fix',
                       'temporary roof repair',
                       'stopgap repair',
                       'temporary seal'],
 'termination bar': ['term bar',
                     'termination flashing bar',
                     'termination strip',
                     'membrane termination bar',
                     'compression bar'],
 'through-wall flashing': ['through wall flashing',
                           'wall through flashing',
                           'barrier flashing',
                           'full depth flashing',
                           'cavity wall flashing'],
 'unprotected openings': ['open penetration',
                          'uncovered opening',
                          'unprotected hole',
                          'unguarded opening',
                          'open roof opening'],
 'vegetation': ['roof vegetation',
                'plant growth',
                'roof plants',
                'vegetative growth',
                'weed growth'],
 'vegetation growth': ['vegetation build-up',
                       'overgrown vegetation',
                       'plant overgrowth',
                       'vegetative growth',
                       'organic growth'],
 'vent pipe': ['plumbing vent', 'vent stack', 'roof vent pipe', 'plumbing vent pipe', 'soil stack'],
 'vented ridge': ['ridge vent',
                  'vented ridge cap',
                  'ridge ventilation',
                  'continuous ridge vent',
                  'ridge vent system'],
 'walkway': ['roof walkway', 'walk pad', 'walkway pad', 'roof path', 'maintenance walkway'],
 'wall membrane flashings': ['wall base flashing',
                             'membrane flashing at wall',
                             'wall flashing membrane',
                             'base flashing at parapet',
                             'wall membrane base'],
 'wall metal flashings': ['wall metal flashing',
                          'metal counterflashing',
                          'sheet metal wall flashing',
                          'metal wall trim',
                          'metal flashing at wall'],
 'wall reglet': ['reglet',
                 'reglet flashing',
                 'wall reglet flashing',
                 'cut reglet',
                 'reglet receiver']}


def get_synonyms(label: str) -> List[str]:
    """Return curated synonym/sub-component phrases for a given label."""
    if not label:
        return []
    key = label.strip().lower()
    return list(_LABEL_SYNONYMS.get(key, []))
